<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel Egresado | UniEmplea</title>

    <style>
        body {
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
            background-color: #f4f6f8;
        }

        /* ===== HEADER ===== */
        header {
            background-color: #0d6efd;
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header h1 {
            margin: 0;
            font-size: 22px;
        }

        .acciones-header a {
            background: white;
            color: #0d6efd;
            padding: 8px 14px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: bold;
            margin-left: 8px;
            font-size: 14px;
        }

        .acciones-header a.logout {
            background: #dc3545;
            color: white;
        }

        .acciones-header a:hover {
            opacity: 0.9;
        }

        /* ===== CONTENEDOR ===== */
        .container {
            max-width: 1100px;
            margin: auto;
            padding: 30px;
        }

        h2 {
            color: #0d6efd;
            margin-top: 0;
        }

        /* ===== ALERTAS ===== */
        .alert {
            padding: 14px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .alert-success {
            background: #d1e7dd;
            color: #0f5132;
        }

        .alert-error {
            background: #f8d7da;
            color: #842029;
        }

        /* ===== CARD ===== */
        .card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            margin-bottom: 25px;
        }

        /* ===== OFERTAS ===== */
        .oferta {
            border-bottom: 1px solid #ddd;
            padding: 15px 0;
        }

        .oferta:last-child {
            border-bottom: none;
        }

        .btn {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            text-decoration: none;
        }

        .btn-primary {
            background: #0d6efd;
            color: white;
        }

        .btn-primary:hover {
            background: #0b5ed7;
        }
    </style>
</head>

<body>

<!-- ===== HEADER ===== -->
<header>
    <h1>Panel Egresado</h1>

    <div class="acciones-header">
        <a href="{{ url_for('egresado.dashboard_egresado') }}">
            Ver Ofertas
        </a>

        <a href="{{ url_for('egresado.hoja_vida') }}">
            Mi Hoja de Vida
        </a>

        <a href="{{ url_for('egresado.historial_academico') }}">
            Estado Acad茅mico
        </a>

        <a href="{{ url_for('auth.logout') }}"
           class="logout"
           onclick="return confirm('驴Desea cerrar sesi贸n?')">
            Cerrar sesi贸n
        </a>
    </div>
</header>

<!-- ===== CONTENIDO ===== -->
<div class="container">

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
        {% for category, message in messages %}
            <div class="alert alert-{{ category }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endif %}
    {% endwith %}

    <!-- OFERTAS -->
    <div class="card">
        <h2>Ofertas Laborales</h2>

        <!-- FILTROS -->
        
        <form method="GET" style="margin-bottom: 20px;">

        <label>
            Ciudad:
            <input type="text" name="ciudad" value="{{ request.args.get('ciudad', '') }}">
        </label>

        <label style="margin-left:10px;">
            Modalidad:
            <select name="modalidad">
                <option value="">Todas</option>
                <option value="presencial" {% if request.args.get('modalidad') == 'presencial' %}selected{% endif %}>
                    Presencial
                </option>
                <option value="virtual" {% if request.args.get('modalidad') == 'virtual' %}selected{% endif %}>
                    Virtual
                </option>
                <option value="hibrido" {% if request.args.get('modalidad') == 'hibrido' %}selected{% endif %}>
                    H铆brido
                </option>
            </select>
        </label>

        <label style="margin-left:10px;">
            Jornada:
            <select name="jornada">
                <option value="">Todas</option>
                <option value="tiempo_completo" {% if request.args.get('jornada') == 'tiempo_completo' %}selected{% endif %}>
                    Tiempo completo
                </option>
                <option value="medio_tiempo" {% if request.args.get('jornada') == 'medio_tiempo' %}selected{% endif %}>
                    Medio tiempo
                </option>
            </select>
        </label>

        <label style="margin-left:10px;">
            Tipo:
            <select name="tipo">
                <option value="">Todos</option>
                <option value="empleo" {% if request.args.get('tipo') == 'empleo' %}selected{% endif %}>
                    Empleo
                </option>
                <option value="practica" {% if request.args.get('tipo') == 'practica' %}selected{% endif %}>
                    Pr谩ctica
                </option>
            </select>
        </label>

        <button type="submit" class="btn btn-primary" style="margin-left:10px;">
             Filtrar
        </button>

        <a href="{{ url_for('egresado.dashboard_egresado') }}"
        class="btn btn-secondary"
        style="margin-left:5px;">
            Limpiar
        </a>

    </form>
        {% if ofertas %}
        {% for oferta in ofertas %}
            <div class="oferta">
                <h3>{{ oferta.titulo }}</h3>
                <p>{{ oferta.descripcion }}</p>

                <p>
                    <strong>Ciudad:</strong> {{ oferta.ciudad or 'No especificada' }} |
                    <strong>Modalidad:</strong> {{ oferta.modalidad or 'N/A' }} |
                    <strong>Jornada:</strong> {{ oferta.jornada or 'N/A' }}
                </p>

                <p>
                    <strong>Salario:</strong> {{ oferta.salario or 'A convenir' }} |
                    <strong>Tipo:</strong> {{ oferta.tipo }}
                </p>

                {% if oferta.ya_postulado %}
                    <p>
                        <strong>Estado:</strong>
                        {% if oferta.estado_postulacion == 'postulado' %}
                            En revisi贸n
                        {% elif oferta.estado_postulacion == 'aceptado' %}
                            Aceptado
                        {% elif oferta.estado_postulacion == 'rechazado' %}
                            Rechazado
                        {% else %}
                            En revisi贸n
                        {% endif %}
                    </p>
                {% else %}
                    <form method="POST"
                        action="{{ url_for('egresado.postular_oferta', oferta_id=oferta.id) }}">
                        <button type="submit" class="btn btn-primary">
                            Postular
                        </button>
                    </form>
                {% endif %}
            </div>
        {% endfor %}
    {% else %}
        <p>No hay ofertas disponibles.</p>
    {% endif %}
